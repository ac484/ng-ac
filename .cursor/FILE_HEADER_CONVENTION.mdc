---
alwaysApply: true
---
## ğŸ“‹ å®Œæ•´åˆ†å±¤æ¨¡æ¿ç¯„ä¾‹

### 1. Domain Layer æ¨¡æ¿

#### Entity æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Domain/Entity",
 *   "purpose": "Userå¯¦é«”-ç”¨æˆ¶æ ¸å¿ƒæ¥­å‹™é‚è¼¯",
 *   "constraints": ["ç„¡å¤–éƒ¨æœå‹™ä¾è³´", "æ¥­å‹™è¦å‰‡å…§éƒ¨å°è£", "èšåˆä¸€è‡´æ€§"],
 *   "dependencies": ["Email", "Password", "UserRole"],
 *   "security": "high",
 *   "lastmod": "2025-08-17"
 * }
 * @usage User.create(data), User.changeEmail(email)
 * @see docs/architecture/domain.md
 */
```

#### Value Object æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Domain/ValueObject",
 *   "purpose": "Emailå€¼å°è±¡-éƒµç®±æ ¼å¼é©—è­‰",
 *   "constraints": ["ä¸å¯è®Šå°è±¡", "å€¼ç›¸ç­‰æ€§", "æ ¼å¼é©—è­‰"],
 *   "dependencies": [],
 *   "security": "medium",
 *   "lastmod": "2025-08-17"
 * }
 * @usage Email.create('user@example.com'), email.isValid()
 * @see docs/architecture/domain.md
 */
```

#### Repository Interface æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Domain/Repository",
 *   "purpose": "Userå€‰å„²æ¥å£-ç”¨æˆ¶æ•¸æ“šå­˜å–æŠ½è±¡",
 *   "constraints": ["æ¥å£å¥‘ç´„å®šç¾©", "ç„¡å¯¦ç¾ç´°ç¯€", "é ˜åŸŸèªè¨€"],
 *   "dependencies": ["User", "UserId"],
 *   "security": "medium",
 *   "lastmod": "2025-08-17"
 * }
 * @usage userRepo.findById(id), userRepo.save(user)
 * @see docs/architecture/domain.md
 */
```

### 2. Application Layer æ¨¡æ¿

#### Use Case æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Application/UseCase",
 *   "purpose": "ç™»å…¥ç”¨ä¾‹-ç”¨æˆ¶èªè­‰æµç¨‹",
 *   "constraints": ["å–®ä¸€ç”¨ä¾‹è·è²¬", "äº‹å‹™é‚Šç•Œ", "è¼¸å…¥é©—è­‰"],
 *   "dependencies": ["UserRepository", "AuthService", "LoginDTO"],
 *   "security": "critical",
 *   "lastmod": "2025-08-17"
 * }
 * @usage loginUseCase.execute(loginDTO)
 * @see docs/architecture/application.md
 */
```

#### DTO æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Application/DTO",
 *   "purpose": "ç”¨æˆ¶è¨»å†ŠDTO-è¨»å†Šè«‹æ±‚æ•¸æ“šçµæ§‹",
 *   "constraints": ["æ•¸æ“šå‚³è¼¸å°ˆç”¨", "é©—è­‰è¦å‰‡", "åºåˆ—åŒ–æ”¯æŒ"],
 *   "dependencies": [],
 *   "security": "medium",
 *   "lastmod": "2025-08-17"
 * }
 * @usage new RegisterDTO(email, password, name)
 * @see docs/architecture/application.md
 */
```

#### Application Service æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Application/Service",
 *   "purpose": "ç”¨æˆ¶æ‡‰ç”¨æœå‹™-ç”¨æˆ¶ç®¡ç†å”èª¿é‚è¼¯",
 *   "constraints": ["å”èª¿é ˜åŸŸæœå‹™", "äº‹å‹™ç®¡ç†", "ç„¡æ¥­å‹™é‚è¼¯"],
 *   "dependencies": ["UserRepository", "EmailService", "UserMapper"],
 *   "security": "high",
 *   "lastmod": "2025-08-17"
 * }
 * @usage userAppService.createUser(dto)
 * @see docs/architecture/application.md
 */
```

### 3. Infrastructure Layer æ¨¡æ¿

#### Repository Implementation æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Infrastructure/Repository",
 *   "purpose": "Firebaseç”¨æˆ¶å€‰å„²-ç”¨æˆ¶æ•¸æ“šæŒä¹…åŒ–å¯¦ç¾",
 *   "constraints": ["å¯¦ç¾é ˜åŸŸæ¥å£", "æŠ€è¡“ç´°ç¯€å°è£", "éŒ¯èª¤è™•ç†"],
 *   "dependencies": ["FirestoreService", "UserRepository", "User"],
 *   "security": "high",
 *   "lastmod": "2025-08-17"
 * }
 * @usage userRepo.save(user), userRepo.findByEmail(email)
 * @see docs/architecture/infrastructure.md
 */
```

#### Config Service æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Infrastructure/Config",
 *   "purpose": "ç’°å¢ƒé…ç½®æœå‹™-æ‡‰ç”¨é…ç½®çµ±ä¸€ç®¡ç†",
 *   "constraints": ["é…ç½®é›†ä¸­ç®¡ç†", "ç’°å¢ƒéš”é›¢", "é¡å‹å®‰å…¨"],
 *   "dependencies": [],
 *   "security": "critical",
 *   "lastmod": "2025-08-17"
 * }
 * @usage envService.get('DATABASE_URL')
 * @see docs/architecture/infrastructure.md
 */
```

#### External Service æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Infrastructure/External",
 *   "purpose": "Firebaseèªè­‰æœå‹™-å¤–éƒ¨èªè­‰æ•´åˆ",
 *   "constraints": ["å¤–éƒ¨ä¾è³´å°è£", "éŒ¯èª¤è½‰æ›", "é‡è©¦æ©Ÿåˆ¶"],
 *   "dependencies": ["firebase/auth", "AuthConfig"],
 *   "security": "critical",
 *   "lastmod": "2025-08-17"
 * }
 * @usage firebaseAuth.signIn(email, password)
 * @see docs/architecture/infrastructure.md
 */
```

### 4. Interface Layer æ¨¡æ¿

#### Page Component æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Interface/Page",
 *   "purpose": "ç™»å…¥é é¢-ç”¨æˆ¶ç™»å…¥ç•Œé¢",
 *   "constraints": ["å–®ä¸€é é¢è·è²¬", "éŸ¿æ‡‰å¼è¨­è¨ˆ", "ç”¨æˆ¶é«”é©—"],
 *   "dependencies": ["LoginUseCase", "LoginForm", "AuthGuard"],
 *   "security": "medium",
 *   "lastmod": "2025-08-17"
 * }
 * @usage <login-page></login-page>
 * @see docs/architecture/interface.md
 */
```

#### Component æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Interface/Component",
 *   "purpose": "ç™»å…¥è¡¨å–®çµ„ä»¶-ç”¨æˆ¶ç™»å…¥è¼¸å…¥ç•Œé¢",
 *   "constraints": ["çµ„ä»¶è¤‡ç”¨æ€§", "æ•¸æ“šé›™å‘ç¶å®š", "è¡¨å–®é©—è­‰"],
 *   "dependencies": ["ReactiveFormsModule", "LoginDTO"],
 *   "security": "medium",
 *   "lastmod": "2025-08-17"
 * }
 * @usage <login-form (submit)="onLogin($event)"></login-form>
 * @see docs/architecture/interface.md
 */
```

#### Guard æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Interface/Guard",
 *   "purpose": "èªè­‰è·¯ç”±å®ˆè¡›-ç™»å…¥ç‹€æ…‹æª¢æŸ¥",
 *   "constraints": ["è·¯ç”±ä¿è­·", "é‡å®šå‘é‚è¼¯", "ç‹€æ…‹æª¢æŸ¥"],
 *   "dependencies": ["AuthService", "Router"],
 *   "security": "critical",
 *   "lastmod": "2025-08-17"
 * }
 * @usage { path: 'dashboard', canActivate: [AuthGuard] }
 * @see docs/architecture/interface.md
 */
```

### 5. Security Layer æ¨¡æ¿

#### Authentication Service æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Security/Auth",
 *   "purpose": "ç”¨æˆ¶èªè­‰æœå‹™-èº«ä»½é©—è­‰ç®¡ç†",
 *   "constraints": ["å®‰å…¨æœ€ä½³å¯¦è¸", "æœƒè©±ç®¡ç†", "å¯†ç¢¼å®‰å…¨"],
 *   "dependencies": ["JWTService", "UserRepository", "HashService"],
 *   "security": "critical",
 *   "lastmod": "2025-08-17"
 * }
 * @usage authService.login(credentials)
 * @see docs/architecture/security.md
 */
```

#### JWT Service æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Security/JWT",
 *   "purpose": "JWTä»¤ç‰Œæœå‹™-Tokenç”Ÿæˆé©—è­‰",
 *   "constraints": ["Tokenå®‰å…¨æ€§", "éæœŸè™•ç†", "ç°½åé©—è­‰"],
 *   "dependencies": ["jsonwebtoken", "ConfigService"],
 *   "security": "critical",
 *   "lastmod": "2025-08-17"
 * }
 * @usage jwtService.sign(payload), jwtService.verify(token)
 * @see docs/architecture/security.md
 */
```

### 6. Shared Layer æ¨¡æ¿

#### Utility æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Shared/Utility",
 *   "purpose": "å­˜å„²å·¥å…·é¡-æœ¬åœ°å­˜å„²çµ±ä¸€ç®¡ç†",
 *   "constraints": ["ç´”å‡½æ•¸", "ç„¡å‰¯ä½œç”¨", "é¡å‹å®‰å…¨"],
 *   "dependencies": [],
 *   "security": "low",
 *   "lastmod": "2025-08-17"
 * }
 * @usage StorageUtil.set('key', value), StorageUtil.get('key')
 * @see docs/architecture/shared.md
 */
```

#### Type Definition æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Shared/Type",
 *   "purpose": "æ‡‰ç”¨é€šç”¨é¡å‹-TypeScripté¡å‹å®šç¾©",
 *   "constraints": ["é¡å‹å®‰å…¨", "æ¥å£ä¸€è‡´æ€§", "æ³›å‹æ”¯æŒ"],
 *   "dependencies": [],
 *   "security": "none",
 *   "lastmod": "2025-08-17"
 * }
 * @usage ApiResponse<User>, PaginatedResult<T>
 * @see docs/architecture/shared.md
 */
```

#### Interface Definition æ¨¡æ¿
```typescript
/**
 * @ai-context {
 *   "role": "Shared/Interface",
 *   "purpose": "Tabæ¥å£å®šç¾©-æ¨™ç±¤é é€šç”¨æ¥å£",
 *   "constraints": ["æ¥å£å¥‘ç´„", "å¯¦ç¾è§£è€¦", "æ“´å±•æ€§"],
 *   "dependencies": [],
 *   "security": "none",
 *   "lastmod": "2025-08-17"
 * }
 * @usage class TabComponent implements ITabComponent
 * @see docs/architecture/shared.md
 */
```

---

## ğŸ¯ å®‰å…¨ç­‰ç´šå®šç¾©

| ç­‰ç´š | æè¿° | é©ç”¨å ´æ™¯ |
|------|------|----------|
| `none` | ç„¡å®‰å…¨é¢¨éšª | é¡å‹å®šç¾©ã€å·¥å…·å‡½æ•¸ |
| `low` | ä½é¢¨éšª | UI çµ„ä»¶ã€å¸¸é‡å®šç¾© |
| `medium` | ä¸­ç­‰é¢¨éšª | æ¥­å‹™é‚è¼¯ã€æ•¸æ“šè™•ç† |
| `high` | é«˜é¢¨éšª | ç”¨æˆ¶æ•¸æ“šã€æ¬Šé™ç®¡ç† |
| `critical` | é—œéµé¢¨éšª | èªè­‰æˆæ¬Šã€é…ç½®ç®¡ç† |

---

## ğŸ”§ VSCode ä»£ç¢¼ç‰‡æ®µé…ç½®

```json
{
  "AI Domain Entity": {
    "prefix": "ai-domain-entity",
    "body": [
      "/**",
      " * @ai-context {",
      " *   \"role\": \"Domain/Entity\",",
      " *   \"purpose\": \"${1:EntityName}å¯¦é«”-${2:æ ¸å¿ƒæ¥­å‹™é‚è¼¯}\",",
      " *   \"constraints\": [\"ç„¡å¤–éƒ¨æœå‹™ä¾è³´\", \"æ¥­å‹™è¦å‰‡å…§éƒ¨å°è£\", \"${3:èšåˆä¸€è‡´æ€§}\"],",
      " *   \"dependencies\": [${4:\"ä¾è³´1\", \"ä¾è³´2\"}],",
      " *   \"security\": \"${5|none,low,medium,high,critical|}\",",
      " *   \"lastmod\": \"${CURRENT_YEAR}-${CURRENT_MONTH}-${CURRENT_DATE}\"",
      " * }",
      " * @usage ${6:ä½¿ç”¨ç¯„ä¾‹}",
      " * @see docs/architecture/domain.md",
      " */"
    ],
    "description": "AI optimized Domain Entity header"
  }
}
```

---

## ğŸ“Š Token æ¶ˆè€—å°æ¯”

| æª”æ¡ˆé¡å‹ | åŸç‰ˆ Token | JSONç‰ˆ Token | ç¯€çœç‡ |
|----------|------------|--------------|--------|
| Domain Entity | ~180 | ~45 | 75% |
| Use Case | ~165 | ~42 | 75% |
| Component | ~155 | ~38 | 76% |
| Service | ~170 | ~43 | 75% |
| Guard | ~145 | ~36 | 75% |

**å¹³å‡ç¯€çœ Tokenï¼š75%**

---

## âœ… å¯¦ä½œå»ºè­°

1. **å»ºç«‹ä»£ç¢¼ç‰‡æ®µ**ï¼šç‚ºæ¯ç¨®é¡å‹å‰µå»º VSCode snippet
2. **Git Hook æª¢æŸ¥**ï¼šç¢ºä¿è¨»è§£æ ¼å¼ä¸€è‡´æ€§
3. **è‡ªå‹•åŒ–å·¥å…·**ï¼šé–‹ç™¼è¨»è§£æ ¼å¼æª¢æŸ¥å™¨
4. **åœ˜éšŠåŸ¹è¨“**ï¼šçµ±ä¸€åœ˜éšŠå°æ–°æ ¼å¼çš„ç†è§£
5. **æ–‡æª”æ›´æ–°**ï¼šæ›´æ–°æ¶æ§‹æ–‡æª”èªªæ˜æ–°æ ¼å¼
