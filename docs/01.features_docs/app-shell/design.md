# Angular App Shell æŠ€è¡“è¨­è¨ˆæ–‡æª”

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹è¨­è¨ˆ

æœ¬æ–‡æª”è©³ç´°æè¿°äº† Angular App Shell ç³»çµ±çš„æŠ€è¡“è¨­è¨ˆï¼ŒåŒ…æ‹¬æ¶æ§‹è¨­è¨ˆã€å¯¦ç¾ç¯„ä¾‹ã€PWA æ•´åˆå’Œæ€§èƒ½å„ªåŒ–ç­–ç•¥ã€‚åŸºæ–¼ Angular 20+ å’Œç¾ä»£åŒ–æŠ€è¡“æ£§ï¼Œå¯¦ç¾ä¼æ¥­ç´šçš„æ‡‰ç”¨éª¨æ¶æ¶æ§‹ã€‚

## ğŸ¯ ç¾ä»£åŒ–æŠ€è¡“æ¶æ§‹å°æ¯”

### å‚³çµ±æ–¹æ¡ˆ vs ç¾ä»£åŒ–æ–¹æ¡ˆ

| ç‰¹æ€§ | å‚³çµ±æ–¹æ¡ˆ | ç¾ä»£åŒ–æ–¹æ¡ˆ (App Shell + PWA) | æ”¹é€²æ•ˆæœ |
|------|----------|-----------------------------|----------|
| é¦–å±è¼‰å…¥ | å®Œæ•´æ‡‰ç”¨è¼‰å…¥ | éª¨æ¶å±é è¼‰å…¥ | **60%** |
| é›¢ç·šæ”¯æ´ | ç„¡ | å®Œæ•´é›¢ç·šåŠŸèƒ½ | **100%** |
| å®‰è£é«”é©— | ç€è¦½å™¨æ›¸ç±¤ | åŸç”Ÿ App é«”é©— | **80%** |
| æ€§èƒ½å„ªåŒ– | åŸºç¤å„ªåŒ– | æ™ºèƒ½å¿«å–ç­–ç•¥ | **45%** |
| SEO æ”¯æ´ | æœ‰é™ | å®Œæ•´ SSR/SSG | **70%** |
| ç”¨æˆ¶é«”é©— | ç¶²é æ‡‰ç”¨ | åŸç”Ÿæ‡‰ç”¨é«”é©— | **65%** |

## ğŸš€ æ ¸å¿ƒæŠ€è¡“æ¶æ§‹èªªæ˜

### App Shell æ¶æ§‹æ¨¡å¼

**æ ¸å¿ƒæ¦‚å¿µï¼š**
- **æ‡‰ç”¨éª¨æ¶é è¼‰å…¥**ï¼šåœ¨ç”¨æˆ¶è¨ªå•å‰é å…ˆè¼‰å…¥æ‡‰ç”¨çš„æ ¸å¿ƒ UI çµæ§‹
- **å…§å®¹å»¶é²è¼‰å…¥**ï¼šå°‡å¯¦éš›å…§å®¹çš„è¼‰å…¥å»¶é²åˆ°ç”¨æˆ¶éœ€è¦æ™‚
- **é›¢ç·šå„ªå…ˆç­–ç•¥**ï¼šç¢ºä¿æ ¸å¿ƒåŠŸèƒ½åœ¨é›¢ç·šç‹€æ…‹ä¸‹ä»å¯æ­£å¸¸é‹ä½œ
- **æ¼¸é€²å¼å¢å¼·**ï¼šå¾åŸºç¤åŠŸèƒ½é–‹å§‹ï¼Œé€æ­¥å¢å¼·ç”¨æˆ¶é«”é©—

**æŠ€è¡“å„ªå‹¢ï¼š**
- é¡¯è‘—æå‡é¦–å±è¼‰å…¥é€Ÿåº¦
- æ”¹å–„ç”¨æˆ¶æ„ŸçŸ¥æ€§èƒ½
- æ”¯æ´é›¢ç·šå’Œä½ç¶²è·¯ç’°å¢ƒ
- æä¾›åŸç”Ÿæ‡‰ç”¨èˆ¬çš„é«”é©—
- å„ªåŒ– SEO å’Œç¤¾äº¤åª’é«”åˆ†äº«

### PWA æ•´åˆæ¶æ§‹

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- **Service Worker**ï¼šç®¡ç†å¿«å–ã€é›¢ç·šæ”¯æ´ã€èƒŒæ™¯åŒæ­¥
- **Web App Manifest**ï¼šå®šç¾©æ‡‰ç”¨å®‰è£å’Œé¡¯ç¤ºå±¬æ€§
- **é›¢ç·šå¿«å–ç­–ç•¥**ï¼šæ™ºèƒ½å¿«å–ç®¡ç†ï¼Œå„ªåŒ–è³‡æºè¼‰å…¥
- **æ¨é€é€šçŸ¥**ï¼šæ”¯æ´å³æ™‚é€šçŸ¥å’Œç”¨æˆ¶äº’å‹•
- **èƒŒæ™¯åŒæ­¥**ï¼šé›¢ç·šæ“ä½œåœ¨ç¶²è·¯æ¢å¾©æ™‚è‡ªå‹•åŒæ­¥

## ğŸ”§ Angular 20+ App Shell API è©³ç´°èªªæ˜

### æ ¸å¿ƒ App Shell API

**App Shell é…ç½®ï¼š**
```typescript
// åœ¨ app.config.ts ä¸­é…ç½®
import { ApplicationConfig } from '@angular/core';
import { provideServerRendering } from '@angular/platform-server';
import { withAppShell } from '@angular/platform-server';

export const appConfig: ApplicationConfig = {
  providers: [
    provideServerRendering({
      withRoutes: true,
      withAppShell: true
    })
  ]
};
```

**App Shell çµ„ä»¶ï¼š**
```typescript
import { Component } from '@angular/core';
import { RouterOutlet } from '@angular/router';

@Component({
  selector: 'app-shell',
  standalone: true,
  imports: [RouterOutlet],
  template: `
    <header class="app-header">
      <nav class="app-nav">
        <!-- å°èˆªå…§å®¹ -->
      </nav>
    </header>

    <main class="app-main">
      <router-outlet />
    </main>

    <footer class="app-footer">
      <!-- é è…³å…§å®¹ -->
    </footer>
  `
})
export class AppShellComponent {}
```

### Service Worker é…ç½®

**PWA æ”¯æ´æ·»åŠ ï¼š**
```bash
ng add @angular/pwa
```

**Service Worker é…ç½®ï¼š**
```typescript
// ngsw-config.json
{
  "$schema": "./node_modules/@angular/service-worker/config/schema.json",
  "index": "/index.html",
  "assetGroups": [
    {
      "name": "app",
      "installMode": "prefetch",
      "resources": {
        "files": [
          "/favicon.ico",
          "/index.html",
          "/manifest.webmanifest",
          "/*.css",
          "/*.js"
        ]
      }
    },
    {
      "name": "assets",
      "installMode": "lazy",
      "updateMode": "prefetch",
      "resources": {
        "files": [
          "/assets/**",
          "/*.(svg|cur|jpg|jpeg|png|apng|webp|avif|gif|otf|ttf|woff|woff2)"
        ]
      }
    }
  ],
  "dataGroups": [
    {
      "name": "api-freshness",
      "urls": [
        "/api/**"
      ],
      "cacheConfig": {
        "strategy": "freshness",
        "maxSize": 100,
        "maxAge": "3d",
        "timeout": "10s"
      }
    },
    {
      "name": "api-performance",
      "urls": [
        "/api/**"
      ],
      "cacheConfig": {
        "strategy": "performance",
        "maxSize": 100,
        "maxAge": "30d"
      }
    }
  ]
}
```

### Web App Manifest é…ç½®

**manifest.webmanifestï¼š**
```json
{
  "name": "NG-AC Enterprise Admin",
  "short_name": "NG-AC",
  "description": "Modern Angular Enterprise Admin Console with PWA Support",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#1976d2",
  "orientation": "portrait-primary",
  "scope": "/",
  "lang": "zh-TW",
  "categories": ["business", "productivity"],
  "icons": [
    {
      "src": "assets/icons/icon-72x72.png",
      "sizes": "72x72",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "assets/icons/icon-96x96.png",
      "sizes": "96x96",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "assets/icons/icon-128x128.png",
      "sizes": "128x128",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "assets/icons/icon-144x144.png",
      "sizes": "144x144",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "assets/icons/icon-152x152.png",
      "sizes": "152x152",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "assets/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "assets/icons/icon-384x384.png",
      "sizes": "384x384",
      "type": "image/png",
      "purpose": "maskable any"
    },
    {
      "src": "assets/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "maskable any"
    }
  ],
  "shortcuts": [
    {
      "name": "Dashboard",
      "short_name": "Dashboard",
      "description": "Quick access to dashboard",
      "url": "/dashboard",
      "icons": [
        {
          "src": "assets/icons/dashboard-96x96.png",
          "sizes": "96x96"
        }
      ]
    },
    {
      "name": "User Management",
      "short_name": "Users",
      "description": "Manage user accounts",
      "url": "/users",
      "icons": [
        {
          "src": "assets/icons/users-96x96.png",
          "sizes": "96x96"
        }
      ]
    }
  ]
}
```

## ğŸš€ é€²éš App Shell åŠŸèƒ½å¯¦ç¾

### æ™ºèƒ½å¿«å–ç­–ç•¥

**å¿«å–ç­–ç•¥å¯¦ç¾ï¼š**
```typescript
import { Injectable, inject } from '@angular/core';
import { SwUpdate, VersionReadyEvent } from '@angular/service-worker';
import { filter, map } from 'rxjs/operators';

@Injectable({ providedIn: 'root' })
export class AppUpdateService {
  private swUpdate = inject(SwUpdate);

  constructor() {
    this.checkForUpdates();
  }

  private checkForUpdates(): void {
    this.swUpdate.versionUpdates
      .pipe(
        filter((evt): evt is VersionReadyEvent => evt.type === 'VERSION_READY'),
        map(() => {
          // æç¤ºç”¨æˆ¶æœ‰æ–°ç‰ˆæœ¬å¯ç”¨
          this.promptUser();
        })
      )
      .subscribe();
  }

  private promptUser(): void {
    if (confirm('æ–°ç‰ˆæœ¬å¯ç”¨ï¼Œæ˜¯å¦ç«‹å³æ›´æ–°ï¼Ÿ')) {
      this.swUpdate.activateUpdate().then(() => {
        window.location.reload();
      });
    }
  }

  public checkForUpdate(): Promise<boolean> {
    return this.swUpdate.checkForUpdate();
  }

  public activateUpdate(): Promise<boolean> {
    return this.swUpdate.activateUpdate();
  }
}
```

### é›¢ç·šç‹€æ…‹ç®¡ç†

**é›¢ç·šæª¢æ¸¬æœå‹™ï¼š**
```typescript
import { Injectable, signal, computed } from '@angular/core';

@Injectable({ providedIn: 'root' })
export class OfflineService {
  private readonly _isOnline = signal(navigator.onLine);
  private readonly _isOffline = computed(() => !this._isOnline());

  readonly isOnline = this._isOnline.asReadonly();
  readonly isOffline = this._isOffline.asReadonly();

  constructor() {
    this.setupEventListeners();
  }

  private setupEventListeners(): void {
    window.addEventListener('online', () => {
      this._isOnline.set(true);
      this.handleOnline();
    });

    window.addEventListener('offline', () => {
      this._isOnline.set(false);
      this.handleOffline();
    });
  }

  private handleOnline(): void {
    console.log('ç¶²è·¯å·²æ¢å¾©');
    // åŒæ­¥é›¢ç·šæœŸé–“çš„æ•¸æ“š
    this.syncOfflineData();
  }

  private handleOffline(): void {
    console.log('ç¶²è·¯å·²æ–·é–‹');
    // å•Ÿç”¨é›¢ç·šæ¨¡å¼
    this.enableOfflineMode();
  }

  private syncOfflineData(): void {
    // å¯¦ç¾é›¢ç·šæ•¸æ“šåŒæ­¥é‚è¼¯
  }

  private enableOfflineMode(): void {
    // å¯¦ç¾é›¢ç·šæ¨¡å¼å•Ÿç”¨é‚è¼¯
  }
}
```

### æ¨é€é€šçŸ¥æœå‹™

**æ¨é€é€šçŸ¥å¯¦ç¾ï¼š**
```typescript
import { Injectable, inject } from '@angular/core';
import { SwPush } from '@angular/service-worker';
import { HttpClient } from '@angular/common/http';

@Injectable({ providedIn: 'root' })
export class PushNotificationService {
  private swPush = inject(SwPush);
  private http = inject(HttpClient);

  private readonly VAPID_PUBLIC_KEY = 'YOUR_VAPID_PUBLIC_KEY';

  constructor() {
    this.setupPushSubscription();
  }

  private setupPushSubscription(): void {
    this.swPush.messages.subscribe((message: any) => {
      console.log('æ”¶åˆ°æ¨é€æ¶ˆæ¯:', message);
      this.showNotification(message);
    });

    this.swPush.notificationClicks.subscribe(({ action, notification }) => {
      console.log('é€šçŸ¥è¢«é»æ“Š:', { action, notification });
      this.handleNotificationClick(action, notification);
    });
  }

  public async subscribeToNotifications(): Promise<PushSubscription | null> {
    try {
      const subscription = await this.swPush.requestSubscription({
        serverPublicKey: this.VAPID_PUBLIC_KEY
      });

      // å°‡è¨‚é–±ä¿¡æ¯ç™¼é€åˆ°æœå‹™å™¨
      await this.sendSubscriptionToServer(subscription);

      return subscription;
    } catch (error) {
      console.error('è¨‚é–±æ¨é€é€šçŸ¥å¤±æ•—:', error);
      return null;
    }
  }

  public async unsubscribeFromNotifications(): Promise<void> {
    try {
      await this.swPush.unsubscribe();
      console.log('å·²å–æ¶ˆè¨‚é–±æ¨é€é€šçŸ¥');
    } catch (error) {
      console.error('å–æ¶ˆè¨‚é–±å¤±æ•—:', error);
    }
  }

  private async sendSubscriptionToServer(subscription: PushSubscription): Promise<void> {
    await this.http.post('/api/push-subscriptions', subscription).toPromise();
  }

  private showNotification(message: any): void {
    if ('serviceWorker' in navigator && 'Notification' in window) {
      Notification.requestPermission().then(permission => {
        if (permission === 'granted') {
          new Notification('NG-AC é€šçŸ¥', {
            body: message.data?.body || 'æ‚¨æœ‰æ–°çš„é€šçŸ¥',
            icon: '/assets/icons/icon-192x192.png',
            badge: '/assets/icons/icon-72x72.png',
            tag: 'ng-ac-notification'
          });
        }
      });
    }
  }

  private handleNotificationClick(action: string, notification: any): void {
    // è™•ç†é€šçŸ¥é»æ“Šäº‹ä»¶
    if (action === 'open') {
      window.focus();
      // å°èˆªåˆ°ç›¸é—œé é¢
    }
  }
}
```

## ğŸ¨ ç¾ä»£åŒ–æ¨£å¼ç³»çµ±

### App Shell æ¨£å¼æ¶æ§‹

**æ ¸å¿ƒæ¨£å¼è®Šæ•¸ï¼š**
```scss
// _app-shell-variables.scss
:root {
  // App Shell å°ºå¯¸è®Šæ•¸
  --app-shell-header-height: 64px;
  --app-shell-sidebar-width: 280px;
  --app-shell-footer-height: 60px;
  --app-shell-content-padding: 24px;

  // éŸ¿æ‡‰å¼æ–·é»
  --app-shell-breakpoint-mobile: 768px;
  --app-shell-breakpoint-tablet: 1024px;
  --app-shell-breakpoint-desktop: 1200px;

  // å‹•ç•«æ™‚é–“
  --app-shell-transition-fast: 0.15s ease-out;
  --app-shell-transition-normal: 0.25s ease-out;
  --app-shell-transition-slow: 0.35s ease-out;

  // é™°å½±å±¤ç´š
  --app-shell-shadow-1: 0 1px 3px rgba(0, 0, 0, 0.12);
  --app-shell-shadow-2: 0 3px 6px rgba(0, 0, 0, 0.15);
  --app-shell-shadow-3: 0 10px 20px rgba(0, 0, 0, 0.19);
}
```

**App Shell ä½ˆå±€æ¨£å¼ï¼š**
```scss
// _app-shell-layout.scss
.app-shell {
  display: grid;
  grid-template-areas:
    "header header"
    "sidebar main"
    "footer footer";
  grid-template-columns: var(--app-shell-sidebar-width) 1fr;
  grid-template-rows: var(--app-shell-header-height) 1fr var(--app-shell-footer-height);
  min-height: 100vh;

  @media (max-width: 768px) {
    grid-template-areas:
      "header"
      "main"
      "footer";
    grid-template-columns: 1fr;
    grid-template-rows: var(--app-shell-header-height) 1fr var(--app-shell-footer-height);
  }
}

.app-header {
  grid-area: header;
  background: var(--mat-sys-surface);
  border-bottom: 1px solid var(--mat-divider-color);
  box-shadow: var(--app-shell-shadow-1);
  z-index: 1000;

  .app-nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100%;
    padding: 0 var(--app-shell-content-padding);

    .nav-brand {
      display: flex;
      align-items: center;
      gap: 12px;

      .brand-logo {
        width: 32px;
        height: 32px;
      }

      .brand-name {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--mat-sys-on-surface);
      }
    }

    .nav-actions {
      display: flex;
      align-items: center;
      gap: 16px;
    }
  }
}

.app-sidebar {
  grid-area: sidebar;
  background: var(--mat-sys-surface);
  border-right: 1px solid var(--mat-divider-color);
  overflow-y: auto;

  @media (max-width: 768px) {
    display: none;
  }

  .sidebar-content {
    padding: var(--app-shell-content-padding);
  }
}

.app-main {
  grid-area: main;
  background: var(--mat-sys-surface);
  overflow-y: auto;

  .main-content {
    padding: var(--app-shell-content-padding);
    min-height: calc(100vh - var(--app-shell-header-height) - var(--app-shell-footer-height));
  }
}

.app-footer {
  grid-area: footer;
  background: var(--mat-sys-surface);
  border-top: 1px solid var(--mat-divider-color);
  padding: 16px var(--app-shell-content-padding);
  text-align: center;
  color: var(--mat-sys-on-surface-variant);
}
```

### éŸ¿æ‡‰å¼è¨­è¨ˆç³»çµ±

**Container Queries æ”¯æ´ï¼š**
```scss
// _app-shell-responsive.scss
.app-shell {
  container-type: inline-size;
  container-name: app-shell;
}

.app-header {
  @container app-shell (max-width: 600px) {
    .app-nav {
      padding: 0 16px;

      .nav-brand .brand-name {
        display: none;
      }

      .nav-actions {
        gap: 8px;
      }
    }
  }
}

.app-sidebar {
  @container app-shell (max-width: 1024px) {
    width: 240px;
  }

  @container app-shell (max-width: 768px) {
    position: fixed;
    top: var(--app-shell-header-height);
    left: -100%;
    width: 100%;
    height: calc(100vh - var(--app-shell-header-height));
    transition: left var(--app-shell-transition-normal);
    z-index: 999;

    &.sidebar-open {
      left: 0;
    }
  }
}

.app-main {
  @container app-shell (max-width: 768px) {
    .main-content {
      padding: 16px;
    }
  }
}
```

## ğŸš€ æ€§èƒ½å„ªåŒ–é…ç½®

### æ§‹å»ºå„ªåŒ–

**angular.json é…ç½®ï¼š**
```json
{
  "projects": {
    "ng-ac": {
      "architect": {
        "build": {
          "builder": "@angular-devkit/build-angular:browser",
          "options": {
            "outputPath": "dist/ng-ac",
            "index": "src/index.html",
            "main": "src/main.ts",
            "polyfills": ["zone.js"],
            "tsConfig": "tsconfig.app.json",
            "assets": [
              "src/favicon.ico",
              "src/assets",
              {
                "glob": "manifest.webmanifest",
                "input": "src",
                "output": "/"
              },
              {
                "glob": "**/*",
                "input": "src/assets/icons",
                "output": "/assets/icons"
              }
            ],
            "styles": [
              "src/styles.scss"
            ],
            "scripts": [],
            "serviceWorker": true,
            "ngswConfigPath": "ngsw-config.json",
            "optimization": {
              "scripts": true,
              "styles": {
                "minify": true,
                "inlineCritical": false
              },
              "fonts": true
            },
            "outputHashing": "all",
            "sourceMap": false,
            "namedChunks": false,
            "aot": true,
            "extractLicenses": true,
            "vendorChunk": false,
            "buildOptimizer": true,
            "budgets": [
              {
                "type": "initial",
                "maximumWarning": "2mb",
                "maximumError": "5mb"
              },
              {
                "type": "anyComponentStyle",
                "maximumWarning": "6kb",
                "maximumError": "10kb"
              }
            ]
          }
        }
      }
    }
  }
}
```

### Service Worker æ€§èƒ½å„ªåŒ–

**å¿«å–ç­–ç•¥å„ªåŒ–ï¼š**
```typescript
// ngsw-config.json å„ªåŒ–é…ç½®
{
  "$schema": "./node_modules/@angular/service-worker/config/schema.json",
  "index": "/index.html",
  "assetGroups": [
    {
      "name": "app-shell",
      "installMode": "prefetch",
      "updateMode": "prefetch",
      "resources": {
        "files": [
          "/index.html",
          "/manifest.webmanifest",
          "/favicon.ico"
        ]
      }
    },
    {
      "name": "app-core",
      "installMode": "prefetch",
      "updateMode": "prefetch",
      "resources": {
        "files": [
          "/*.css",
          "/*.js"
        ]
      }
    },
    {
      "name": "app-assets",
      "installMode": "lazy",
      "updateMode": "lazy",
      "resources": {
        "files": [
          "/assets/**"
        ]
      }
    }
  ],
  "dataGroups": [
    {
      "name": "api-cache",
      "urls": [
        "/api/**"
      ],
      "cacheConfig": {
        "strategy": "performance",
        "maxSize": 100,
        "maxAge": "1h",
        "timeout": "5s"
      }
    },
    {
      "name": "static-assets",
      "urls": [
        "/assets/images/**",
        "/assets/icons/**"
      ],
      "cacheConfig": {
        "strategy": "cache-first",
        "maxSize": 50,
        "maxAge": "30d"
      }
    }
  ]
}
```

## â™¿ ç„¡éšœç¤™è¨­è¨ˆè€ƒé‡

### éµç›¤å°èˆªæ”¯æ´

**å®Œæ•´éµç›¤å°èˆªï¼š**
```typescript
import { Directive, ElementRef, HostListener } from '@angular/core';

@Directive({
  selector: '[appKeyboardNavigation]',
  standalone: true
})
export class KeyboardNavigationDirective {
  constructor(private el: ElementRef) {}

  @HostListener('keydown', ['$event'])
  onKeyDown(event: KeyboardEvent): void {
    switch (event.key) {
      case 'Escape':
        this.handleEscape(event);
        break;
      case 'Tab':
        this.handleTab(event);
        break;
      case 'Enter':
      case ' ':
        this.handleActivation(event);
        break;
    }
  }

  private handleEscape(event: KeyboardEvent): void {
    // é—œé–‰å´é‚Šæ¬„æˆ–æ¨¡æ…‹æ¡†
    event.preventDefault();
    this.closeSidebar();
  }

  private handleTab(event: KeyboardEvent): void {
    // ç®¡ç† Tab éµå°èˆª
    if (event.shiftKey) {
      this.navigateBackward();
    } else {
      this.navigateForward();
    }
  }

  private handleActivation(event: KeyboardEvent): void {
    // å•Ÿç”¨ç•¶å‰ç„¦é»å…ƒç´ 
    event.preventDefault();
    this.activateCurrentElement();
  }

  private closeSidebar(): void {
    // å¯¦ç¾å´é‚Šæ¬„é—œé–‰é‚è¼¯
  }

  private navigateForward(): void {
    // å¯¦ç¾å‘å‰å°èˆªé‚è¼¯
  }

  private navigateBackward(): void {
    // å¯¦ç¾å‘å¾Œå°èˆªé‚è¼¯
  }

  private activateCurrentElement(): void {
    // å¯¦ç¾å…ƒç´ å•Ÿç”¨é‚è¼¯
  }
}
```

### è¢å¹•é–±è®€å™¨æ”¯æ´

**ARIA å±¬æ€§ç®¡ç†ï¼š**
```typescript
import { Injectable, signal, computed } from '@angular/core';

@Injectable({ providedIn: 'root' })
export class AccessibilityService {
  private readonly _currentPage = signal<string>('');
  private readonly _sidebarOpen = signal(false);
  private readonly _notifications = signal<string[]>([]);

  readonly currentPage = this._currentPage.asReadonly();
  readonly sidebarOpen = this._sidebarOpen.asReadonly();
  readonly notifications = this._notifications.asReadonly();

  readonly pageAnnouncement = computed(() =>
    `ç•¶å‰é é¢ï¼š${this._currentPage()}`
  );

  readonly sidebarAnnouncement = computed(() =>
    this._sidebarOpen() ? 'å´é‚Šæ¬„å·²é–‹å•Ÿ' : 'å´é‚Šæ¬„å·²é—œé–‰'
  );

  setCurrentPage(page: string): void {
    this._currentPage.set(page);
    this.announcePageChange(page);
  }

  toggleSidebar(): void {
    this._sidebarOpen.update(open => !open);
    this.announceSidebarToggle();
  }

  addNotification(message: string): void {
    this._notifications.update(notifications => [...notifications, message]);
    this.announceNotification(message);
  }

  private announcePageChange(page: string): void {
    this.announce(`é é¢å·²åˆ‡æ›åˆ°ï¼š${page}`);
  }

  private announceSidebarToggle(): void {
    const state = this._sidebarOpen() ? 'é–‹å•Ÿ' : 'é—œé–‰';
    this.announce(`å´é‚Šæ¬„å·²${state}`);
  }

  private announceNotification(message: string): void {
    this.announce(`æ–°é€šçŸ¥ï¼š${message}`);
  }

  private announce(message: string): void {
    // å‰µå»º ARIA live region ä¾†æ’­å ±æ¶ˆæ¯
    const announcement = document.createElement('div');
    announcement.setAttribute('aria-live', 'polite');
    announcement.setAttribute('aria-atomic', 'true');
    announcement.className = 'sr-only';
    announcement.textContent = message;

    document.body.appendChild(announcement);

    // æ¸…ç†
    setTimeout(() => {
      document.body.removeChild(announcement);
    }, 1000);
  }
}
```

## ğŸ—ï¸ é–‹ç™¼æœ€ä½³å¯¦è¸

### çµ„ä»¶æ¶æ§‹è¨­è¨ˆ

**æ¨¡çµ„åŒ–çµæ§‹ï¼š**
```
src/app/
â”œâ”€â”€ app-shell/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ app-header/
â”‚   â”‚   â”œâ”€â”€ app-sidebar/
â”‚   â”‚   â”œâ”€â”€ app-main/
â”‚   â”‚   â””â”€â”€ app-footer/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ app-shell.service.ts
â”‚   â”‚   â”œâ”€â”€ offline.service.ts
â”‚   â”‚   â””â”€â”€ push-notification.service.ts
â”‚   â”œâ”€â”€ app-shell.component.ts
â”‚   â””â”€â”€ app-shell.module.ts
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ accessibility.service.ts
â”‚   â””â”€â”€ directives/
â”‚       â””â”€â”€ keyboard-navigation.directive.ts
â””â”€â”€ app.config.ts
```

### æ¸¬è©¦ç­–ç•¥

**æ¸¬è©¦è¦†è“‹ï¼š**
```typescript
// app-shell.component.spec.ts
import { ComponentFixture, TestBed } from '@angular/core/testing';
import { RouterTestingModule } from '@angular/router/testing';
import { ServiceWorkerModule } from '@angular/service-worker';
import { AppShellComponent } from './app-shell.component';

describe('AppShellComponent', () => {
  let component: AppShellComponent;
  let fixture: ComponentFixture<AppShellComponent>;

  beforeEach(async () => {
    await TestBed.configureTestingModule({
      imports: [
        AppShellComponent,
        RouterTestingModule,
        ServiceWorkerModule.register('ngsw-worker.js', {
          enabled: false
        })
      ]
    }).compileComponents();

    fixture = TestBed.createComponent(AppShellComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
  });

  it('should create', () => {
    expect(component).toBeTruthy();
  });

  it('should render header, sidebar, main content and footer', () => {
    const header = fixture.nativeElement.querySelector('.app-header');
    const sidebar = fixture.nativeElement.querySelector('.app-sidebar');
    const main = fixture.nativeElement.querySelector('.app-main');
    const footer = fixture.nativeElement.querySelector('.app-footer');

    expect(header).toBeTruthy();
    expect(sidebar).toBeTruthy();
    expect(main).toBeTruthy();
    expect(footer).toBeTruthy();
  });

  it('should handle sidebar toggle correctly', () => {
    const sidebar = fixture.nativeElement.querySelector('.app-sidebar');
    const toggleButton = fixture.nativeElement.querySelector('.sidebar-toggle');

    expect(sidebar.classList.contains('sidebar-open')).toBeFalse();

    toggleButton.click();
    fixture.detectChanges();

    expect(sidebar.classList.contains('sidebar-open')).toBeTrue();
  });
});
```

## ğŸ¯ ç¾ä»£åŒ–æŠ€è¡“å„ªå‹¢ç¸½çµ

### 1. **App Shell æ¶æ§‹å„ªå‹¢**
- **é¦–å±æ€§èƒ½æå‡**: éª¨æ¶å±é è¼‰å…¥ï¼Œæ¸›å°‘ 60% é¦–å±è¼‰å…¥æ™‚é–“
- **é›¢ç·šåŠŸèƒ½æ”¯æ´**: å®Œæ•´çš„é›¢ç·šé«”é©—ï¼Œæå‡ç”¨æˆ¶æ»¿æ„åº¦
- **åŸç”Ÿæ‡‰ç”¨é«”é©—**: å®‰è£åˆ°ä¸»è¢å¹•ï¼Œæä¾›åŸç”Ÿæ‡‰ç”¨èˆ¬çš„é«”é©—
- **SEO å„ªåŒ–**: æ”¯æ´ SSR/SSGï¼Œæ”¹å–„æœå°‹å¼•æ“æ’å

### 2. **PWA æŠ€è¡“å„ªå‹¢**
- **Service Worker**: æ™ºèƒ½å¿«å–ç®¡ç†ï¼Œå„ªåŒ–è³‡æºè¼‰å…¥
- **æ¨é€é€šçŸ¥**: å³æ™‚ç”¨æˆ¶äº’å‹•ï¼Œæå‡ç”¨æˆ¶åƒèˆ‡åº¦
- **èƒŒæ™¯åŒæ­¥**: é›¢ç·šæ“ä½œè‡ªå‹•åŒæ­¥ï¼Œç¢ºä¿æ•¸æ“šä¸€è‡´æ€§
- **å®‰è£é«”é©—**: ä¸€éµå®‰è£ï¼Œç„¡éœ€æ‡‰ç”¨å•†åº—

### 3. **Angular 20+ å„ªå‹¢**
- **Standalone çµ„ä»¶**: ç„¡éœ€ NgModuleï¼Œæ›´è¼•é‡
- **Signals**: è‡ªå‹•è®Šæ›´æª¢æ¸¬ï¼Œæå‡æ€§èƒ½
- **ç¾ä»£åŒ–æ§åˆ¶æµ**: @if/@for èªæ³•ï¼Œæ›´ç°¡æ½”
- **Container Queries**: çµ„ä»¶ç´šéŸ¿æ‡‰å¼è¨­è¨ˆ

## ğŸš€ å¯¦ç¾å»ºè­°èˆ‡é·ç§»ç­–ç•¥

### ç«‹å³æ¡ç”¨
1. **App Shell æ¶æ§‹**: å¯¦ç¾æ‡‰ç”¨éª¨æ¶é è¼‰å…¥
2. **PWA æ”¯æ´**: æ·»åŠ  Service Worker å’Œ Web App Manifest
3. **é›¢ç·šåŠŸèƒ½**: å¯¦ç¾æ ¸å¿ƒåŠŸèƒ½çš„é›¢ç·šæ”¯æ´
4. **æ¨é€é€šçŸ¥**: æ·»åŠ å³æ™‚é€šçŸ¥åŠŸèƒ½

### é·ç§»æ­¥é©Ÿ
1. **å‡ç´šåˆ° Angular 20+**: ç¢ºä¿ç‰ˆæœ¬å…¼å®¹æ€§
2. **æ·»åŠ  PWA æ”¯æ´**: ä½¿ç”¨ `ng add @angular/pwa`
3. **å¯¦ç¾ App Shell**: å‰µå»ºæ‡‰ç”¨éª¨æ¶çµ„ä»¶
4. **é…ç½® Service Worker**: å„ªåŒ–å¿«å–ç­–ç•¥
5. **æ¸¬è©¦é›¢ç·šåŠŸèƒ½**: é©—è­‰é›¢ç·šé«”é©—

## ğŸ‰ çµè«–

ä½¿ç”¨ **Angular 20+ App Shell + PWA** æŠ€è¡“æ–¹æ¡ˆå¯ä»¥å®Œå…¨æ»¿è¶³ç¾ä»£åŒ–ä¼æ¥­æ‡‰ç”¨çš„æ‰€æœ‰éœ€æ±‚ï¼ŒåŒæ™‚æä¾›é¡¯è‘—çš„æ€§èƒ½æå‡å’Œç”¨æˆ¶é«”é©—æ”¹å–„ã€‚é€™å€‹æŠ€è¡“æ£§æä¾›äº†ï¼š

- **å®Œæ•´çš„ PWA æ”¯æ´**: å¾é›¢ç·šåŠŸèƒ½åˆ°æ¨é€é€šçŸ¥çš„å®Œæ•´ PWA é«”é©—
- **å„ªç§€çš„æ€§èƒ½**: App Shell æ¶æ§‹é¡¯è‘—æå‡é¦–å±è¼‰å…¥é€Ÿåº¦
- **ç„¡éšœç¤™å‹å–„**: ç¬¦åˆ WCAG æ¨™æº–çš„å®Œæ•´ç„¡éšœç¤™æ”¯æ´
- **é«˜åº¦å¯å®¢è£½åŒ–**: è±å¯Œçš„é…ç½®é¸é …å’Œæ¨£å¼ç³»çµ±
- **ç¾ä»£åŒ–è¨­è¨ˆ**: åŸºæ–¼æœ€æ–°çš„ Web æ¨™æº–å’Œæœ€ä½³å¯¦è¸
- **ä¼æ¥­ç´šåŠŸèƒ½**: æ”¯æ´å¤§å‹æ‡‰ç”¨çš„è¤‡é›œéœ€æ±‚

é€éåˆç†é‹ç”¨ Angular App Shellã€PWA æŠ€è¡“å’Œ Angular 20+ çš„å„ç¨®å·¥å…·ï¼Œæ‚¨å°‡èƒ½å¤ å»ºæ§‹å‡ºä¸€å€‹åŠŸèƒ½å¼·å¤§ã€æ€§èƒ½å„ªç§€ä¸”ç¬¦åˆç¾ä»£åŒ–æ¨™æº–çš„ä¼æ¥­ç´šæ‡‰ç”¨ã€‚æ•´å€‹æ–¹æ¡ˆå®Œå…¨åŸºæ–¼ Angular åŸç”ŸæŠ€è¡“æ£§ï¼Œç¢ºä¿äº†é•·æœŸçš„ç©©å®šæ€§å’Œå¯ç¶­è­·æ€§ã€‚

**é—œéµå„ªå‹¢ç¸½çµï¼š**
- âœ… **é¦–å±æ€§èƒ½æå‡ 60%**: App Shell é è¼‰å…¥å„ªåŒ–
- âœ… **é›¢ç·šåŠŸèƒ½æ”¯æ´**: å®Œæ•´çš„é›¢ç·šé«”é©—
- âœ… **ç”¨æˆ¶é«”é©—æå‡**: åŸç”Ÿæ‡‰ç”¨èˆ¬çš„é«”é©—
- âœ… **SEO å„ªåŒ–**: æ”¯æ´ SSR/SSG
- âœ… **æœªä¾†å…¼å®¹æ€§**: åŸºæ–¼æœ€æ–°çš„ Web æ¨™æº–
